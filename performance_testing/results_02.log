
Database             Time                 Version
-------------------- -------------------- ------------------------------
Start: FREE          25-JUN-2025 07:17:50 Version 23.4.0.24.05

SQL> VAR TIMER_SET NUMBER
SQL> DELETE log_lines;

209 rows deleted.

SQL> EXEC :TIMER_SET := Timer_Set.Construct('Run_All');

PL/SQL procedure successfully completed.

SQL> @run_dp 10000 12 22   2 N
Create data - 10000 coupons, 12 caps per coupon, 22 caps

Table truncated.


Table truncated.


Table truncated.

old   2:   l_n_cou               PLS_INTEGER := &N_COU;
new   2:   l_n_cou               PLS_INTEGER := 10000;
old   3:   l_n_cap_per_cou       PLS_INTEGER := &N_CAP_PER_COU;
new   3:   l_n_cap_per_cou       PLS_INTEGER := 12;
old   4:   l_n_cap               PLS_INTEGER := &N_CAP;
new   4:   l_n_cap               PLS_INTEGER := 22;
old   5:   l_n_views             PLS_INTEGER := &N_VIEWS;
new   5:   l_n_views             PLS_INTEGER := 2;
old   6:   l_get_xplan           BOOLEAN := '&XPLAN_YN' = 'Y';
new   6:   l_get_xplan           BOOLEAN := 'N' = 'Y';

PL/SQL procedure successfully completed.

SQL> @run_dp 20000 12 22 2 Y
Create data - 20000 coupons, 12 caps per coupon, 22 caps

Table truncated.


Table truncated.


Table truncated.

old   2:   l_n_cou               PLS_INTEGER := &N_COU;
new   2:   l_n_cou               PLS_INTEGER := 20000;
old   3:   l_n_cap_per_cou       PLS_INTEGER := &N_CAP_PER_COU;
new   3:   l_n_cap_per_cou       PLS_INTEGER := 12;
old   4:   l_n_cap               PLS_INTEGER := &N_CAP;
new   4:   l_n_cap               PLS_INTEGER := 22;
old   5:   l_n_views             PLS_INTEGER := &N_VIEWS;
new   5:   l_n_views             PLS_INTEGER := 2;
old   6:   l_get_xplan           BOOLEAN := '&XPLAN_YN' = 'Y';
new   6:   l_get_xplan           BOOLEAN := 'Y' = 'Y';

PL/SQL procedure successfully completed.

SQL> @run_dp 1000 12 22   3 N
Create data - 1000 coupons, 12 caps per coupon, 22 caps

Table truncated.


Table truncated.


Table truncated.

old   2:   l_n_cou               PLS_INTEGER := &N_COU;
new   2:   l_n_cou               PLS_INTEGER := 1000;
old   3:   l_n_cap_per_cou       PLS_INTEGER := &N_CAP_PER_COU;
new   3:   l_n_cap_per_cou       PLS_INTEGER := 12;
old   4:   l_n_cap               PLS_INTEGER := &N_CAP;
new   4:   l_n_cap               PLS_INTEGER := 22;
old   5:   l_n_views             PLS_INTEGER := &N_VIEWS;
new   5:   l_n_views             PLS_INTEGER := 3;
old   6:   l_get_xplan           BOOLEAN := '&XPLAN_YN' = 'Y';
new   6:   l_get_xplan           BOOLEAN := 'N' = 'Y';

PL/SQL procedure successfully completed.

SQL> @run_dp 2000 12 22 3 Y
Create data - 2000 coupons, 12 caps per coupon, 22 caps

Table truncated.


Table truncated.


Table truncated.

old   2:   l_n_cou               PLS_INTEGER := &N_COU;
new   2:   l_n_cou               PLS_INTEGER := 2000;
old   3:   l_n_cap_per_cou       PLS_INTEGER := &N_CAP_PER_COU;
new   3:   l_n_cap_per_cou       PLS_INTEGER := 12;
old   4:   l_n_cap               PLS_INTEGER := &N_CAP;
new   4:   l_n_cap               PLS_INTEGER := 22;
old   5:   l_n_views             PLS_INTEGER := &N_VIEWS;
new   5:   l_n_views             PLS_INTEGER := 3;
old   6:   l_get_xplan           BOOLEAN := '&XPLAN_YN' = 'Y';
new   6:   l_get_xplan           BOOLEAN := 'Y' = 'Y';

PL/SQL procedure successfully completed.

SQL> EXEC Utils.L(Timer_Set.Format_Results(:TIMER_SET));

PL/SQL procedure successfully completed.

SQL> SET HEAD OFF
SQL> SELECT line FROM log_lines ORDER BY id;

create_Test_Data 10000 - 12 - 22
Result for coupon_caps_plf_agg_v 10000 - 12 - 22: 10004|120000|2004075
Result for coupon_caps_mod_agg_v 10000 - 12 - 22: 10004|120000|2004075
create_Test_Data 20000 - 12 - 22
Result for coupon_caps_plf_agg_v 20000 - 12 - 22: 20005|240000|3985586
SQL_ID  7araq74cssp19, child number 0
-------------------------------------
SELECT /*+ gather_plan_statistics coupon_caps_plf_agg_v266230 */
Utils.Join_Values(L1_chr_arr(n_pos_usages,n_rows,sum_usage), '|') FROM
coupon_caps_plf_agg_v WHERE 1=1 ORDER BY 1

Plan hash value: 1289100141

-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                           | Name                  | Starts | E-Rows | A-Rows |   A-Time   | Buffers |
-----------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                    |                       |      1 |        |      1 |00:00:01.11 |     898 |
|   1 |  VIEW                               | COUPON_CAPS_PLF_AGG_V |      1 |      1 |      1 |00:00:01.11 |     898 |
|   2 |   SORT AGGREGATE                    |                       |      1 |      1 |      1 |00:00:01.11 |     898 |
|   3 |    COLLECTION ITERATOR PICKLER FETCH| CAPS                  |      1 |   8168 |    240K|00:00:01.91 |     898 |
-----------------------------------------------------------------------------------------------------------------------

Result for XPLAN-coupon_caps_plf_agg_v 20000 - 12 - 22: 20005|240000|3985586
Result for coupon_caps_mod_agg_v 20000 - 12 - 22: 20005|240000|3985586
SQL_ID  1p4n4n49bdxsg, child number 0
-------------------------------------
SELECT /*+ gather_plan_statistics coupon_caps_mod_agg_v236709 */
Utils.Join_Values(L1_chr_arr(n_pos_usages,n_rows,sum_usage), '|') FROM
coupon_caps_mod_agg_v WHERE 1=1 ORDER BY 1

Plan hash value: 1708460470

------------------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                   | Name                  | Starts | E-Rows | A-Rows |   A-Time   | Buffers |  OMem |  1Mem | Used-Mem |
------------------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |                       |      1 |        |      1 |00:00:06.91 |     895 |       |       |          |
|   1 |  VIEW                       | COUPON_CAPS_MOD_AGG_V |      1 |      1 |      1 |00:00:06.91 |     895 |       |       |          |
|   2 |   SORT AGGREGATE            |                       |      1 |      1 |      1 |00:00:06.91 |     895 |       |       |          |
|   3 |    VIEW                     | COUPON_CAPS_MOD_V     |      1 |    238K|    240K|00:00:06.95 |     895 |       |       |          |
|   4 |     SQL MODEL ORDERED FAST  |                       |      1 |    238K|    240K|00:00:06.87 |     895 |    35M|  4521K|   35M (0)|
|   5 |      WINDOW SORT            |                       |      1 |    238K|    240K|00:00:01.47 |     895 |    17M|  1540K|   15M (0)|
|   6 |       WINDOW SORT           |                       |      1 |    238K|    240K|00:00:00.85 |     895 |    14M|  1452K|   13M (0)|
|   7 |        VIEW                 |                       |      1 |    238K|    240K|00:00:00.26 |     895 |       |       |          |
|   8 |         WINDOW SORT         |                       |      1 |    238K|    240K|00:00:00.26 |     895 |    17M|  1575K|   15M (0)|
|*  9 |          HASH JOIN          |                       |      1 |    238K|    240K|00:00:00.05 |     895 |  1744K|  1744K| 1474K (0)|
|  10 |           TABLE ACCESS FULL | CAP_DATA              |      1 |     22 |     22 |00:00:00.01 |       7 |       |       |          |
|* 11 |           HASH JOIN         |                       |      1 |    238K|    240K|00:00:00.03 |     888 |  2400K|  2259K| 2138K (0)|
|  12 |            TABLE ACCESS FULL| COUPON_DATA           |      1 |  20000 |  20000 |00:00:00.01 |      53 |       |       |          |
|  13 |            TABLE ACCESS FULL| COUPON_CAP_MAPPING    |      1 |    240K|    240K|00:00:00.01 |     835 |       |       |          |
------------------------------------------------------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   9 - access("CCM"."CAP_NAME"="CAP"."CAP_NAME")
  11 - access("COU"."COUPON"="CCM"."COUPON")

Result for XPLAN-coupon_caps_mod_agg_v 20000 - 12 - 22: 20005|240000|3985586
create_Test_Data 1000 - 12 - 22
Result for coupon_caps_plf_agg_v 1000 - 12 - 22: 1001|12000|201075
Result for coupon_caps_mod_agg_v 1000 - 12 - 22: 1001|12000|201075
Result for coupon_caps_rsf_agg_v 1000 - 12 - 22: 1001|12000|201075
create_Test_Data 2000 - 12 - 22
Result for coupon_caps_plf_agg_v 2000 - 12 - 22: 2000|24000|401900
Result for coupon_caps_mod_agg_v 2000 - 12 - 22: 2000|24000|401900
Result for coupon_caps_rsf_agg_v 2000 - 12 - 22: 2000|24000|401900
SQL_ID  4dp65hu42dd0a, child number 0
-------------------------------------
SELECT /*+ gather_plan_statistics coupon_caps_rsf_agg_v902786 */
Utils.Join_Values(L1_chr_arr(n_pos_usages,n_rows,sum_usage), '|') FROM
coupon_caps_rsf_agg_v WHERE 1=1 ORDER BY 1

Plan hash value: 4125797728

----------------------------------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                                   | Name                  | Starts | E-Rows | A-Rows |   A-Time   | Buffers |  OMem |  1Mem | Used-Mem |
----------------------------------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                            |                       |      1 |        |      1 |00:01:33.39 |      36M|       |       |          |
|   1 |  VIEW                                       | COUPON_CAPS_RSF_AGG_V |      1 |      1 |      1 |00:01:33.39 |      36M|       |       |          |
|   2 |   SORT AGGREGATE                            |                       |      1 |      1 |      1 |00:01:33.39 |      36M|       |       |          |
|*  3 |    VIEW                                     |                       |      1 |     28G|  24000 |00:03:53.64 |      36M|       |       |          |
|   4 |     UNION ALL (RECURSIVE WITH) BREADTH FIRST|                       |      1 |        |  44022 |00:01:41.32 |      36M|  2048 |  2048 |  102K (0)|
|   5 |      TABLE ACCESS FULL                      | CAP_DATA              |      1 |     22 |     22 |00:00:00.01 |       7 |       |       |          |
|   6 |      WINDOW SORT                            |                       |   2001 |     28G|  44000 |00:00:13.43 |     168K|  4096 |  4096 | 4096  (0)|
|*  7 |       HASH JOIN RIGHT OUTER                 |                       |   2001 |     28G|  44000 |00:00:13.29 |     168K|  2654K|  1931K| 2282K (0)|
|   8 |        TABLE ACCESS FULL                    | COUPON_CAP_MAPPING    |   2001 |  24000 |     48M|00:00:02.37 |     168K|       |       |          |
|*  9 |        HASH JOIN                            |                       |   2001 |     28G|  44000 |00:00:01.91 |      95 |  1506K|  1506K| 1584K (0)|
|  10 |         BUFFER SORT (REUSE)                 |                       |   2001 |        |   4002K|00:00:00.43 |      94 |   115K|   115K|  102K (0)|
|  11 |          VIEW                               |                       |      1 |   2000 |   2000 |00:00:00.01 |      94 |       |       |          |
|  12 |           WINDOW SORT                       |                       |      1 |   2000 |   2000 |00:00:00.01 |      94 | 90112 | 90112 |79872  (0)|
|* 13 |            HASH JOIN SEMI                   |                       |      1 |   2000 |   2000 |00:00:00.01 |      94 |  1695K|  1695K| 1683K (0)|
|  14 |             TABLE ACCESS FULL               | COUPON_DATA           |      1 |   2000 |   2000 |00:00:00.01 |       7 |       |       |          |
|  15 |             INDEX FAST FULL SCAN            | CCM_PK                |      1 |  24000 |  23986 |00:00:00.01 |      87 |       |       |          |
|* 16 |         HASH JOIN                           |                       |   2001 |   1408M|  44022 |00:00:00.36 |       1 |  1506K|  1506K| 1675K (0)|
|  17 |          BUFFER SORT (REUSE)                |                       |   2001 |        |  44022 |00:00:00.02 |       1 | 73728 | 73728 |          |
|  18 |           INDEX FULL SCAN                   | CAP_PK                |      1 |     22 |     22 |00:00:00.01 |       1 |       |       |          |
|  19 |          RECURSIVE WITH PUMP                |                       |   2001 |        |  44022 |00:00:00.02 |       0 |       |       |          |
----------------------------------------------------------------------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   3 - filter(("COUPON" IS NOT NULL AND "CAP_SEQUENCE" IS NOT NULL))
   7 - access("CCM"."COUPON"="COU"."COUPON" AND "CCM"."CAP_NAME"="RSF"."CAP_NAME")
   9 - access("COU"."COU_IND"="RSF"."COU_IND"+1)
  13 - access("CCM"."COUPON"="COU"."COUPON")
  16 - access("CAP"."CAP_NAME"="RSF"."CAP_NAME")

Result for XPLAN-coupon_caps_rsf_agg_v 2000 - 12 - 22: 2000|24000|401900
Timer Set: Run_All, Constructed at 25 Jun 2025 07:17:50, written at 07:22:53
============================================================================
Timer                                           Elapsed         CPU       Calls       Ela/Call       CPU/Call
-------------------------------------------  ----------  ----------  ----------  -------------  -------------
create_Test_Data: 10000 - 12 - 22                 16.49       15.59           1       16.48845       15.59000
coupon_caps_plf_agg_v 10000 - 12 - 22              0.56        0.56           1        0.56268        0.56000
coupon_caps_mod_agg_v 10000 - 12 - 22              2.99        2.83           1        2.98878        2.83000
create_Test_Data: 20000 - 12 - 22                 31.13       29.05           1       31.12900       29.05000
coupon_caps_plf_agg_v 20000 - 12 - 22              1.05        1.02           1        1.05336        1.02000
XPLAN-coupon_caps_plf_agg_v 20000 - 12 - 22        1.13        1.09           1        1.13377        1.09000
coupon_caps_mod_agg_v 20000 - 12 - 22              6.22        6.04           1        6.21509        6.04000
XPLAN-coupon_caps_mod_agg_v 20000 - 12 - 22        6.92        5.97           1        6.92039        5.97000
create_Test_Data: 1000 - 12 - 22                   3.40        2.45           1        3.39995        2.45000
Sum-coupon_caps_plf_agg_v                          0.29        0.21           2        0.14715        0.10500
Sum-coupon_caps_mod_agg_v                          1.16        0.88           2        0.57882        0.44000
coupon_caps_rsf_agg_v 1000 - 12 - 22              31.29       21.91           1       31.28547       21.91000
create_Test_Data: 2000 - 12 - 22                   5.79        3.61           1        5.78578        3.61000
coupon_caps_rsf_agg_v 2000 - 12 - 22             101.31       94.67           1      101.30511       94.67000
XPLAN-coupon_caps_rsf_agg_v 2000 - 12 - 22        93.41       87.77           1       93.41258       87.77000
(Other)                                            0.26        0.24           1        0.25786        0.24000
-------------------------------------------  ----------  ----------  ----------  -------------  -------------
Total                                            303.39      273.89          18       16.85501       15.21611
-------------------------------------------  ----------  ----------  ----------  -------------  -------------
[Timer timed (per call in ms): Elapsed: 0.03184, CPU: 0.03438]

133 rows selected.

SQL> @..\install_prereq\endspool

End: 25-JUN-2025 07:22:53

